DROP TABLE ORDER_ITEM_ADDITIVES;
DROP TABLE ORDER_ITEM_ACCESSORIES;
DROP TABLE ORDER_ITEMS;
DROP TABLE ORDERS;
DROP TABLE DRINKS;
DROP TABLE ADDITIVES;
DROP TABLE ACCESSORIES;
DROP SEQUENCE GLOBAL_SEQ;

CREATE SEQUENCE IF NOT EXISTS GLOBAL_SEQ
  AS INTEGER
  START WITH 100100;

CREATE TABLE IF NOT EXISTS orders
(
  id INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY
);

CREATE TABLE IF NOT EXISTS drinks
(
  id    INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  name  VARCHAR(255) NOT NULL,
  price INTEGER      NOT NULL,
  type  VARCHAR(2)
);

CREATE TABLE IF NOT EXISTS additives
(
  id    INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  name  VARCHAR(255) NOT NULL,
  price INTEGER      NOT NULL,
  type  VARCHAR(2)
);

CREATE TABLE IF NOT EXISTS accessories
(
  id    INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  name  VARCHAR(255) NOT NULL,
  price INTEGER      NOT NULL,
  type  VARCHAR(2)
);


CREATE TABLE IF NOT EXISTS order_items
(
  id       INTEGER GENERATED BY DEFAULT AS SEQUENCE GLOBAL_SEQ PRIMARY KEY,
  order_id INTEGER NOT NULL,
  drink_id INTEGER NOT NULL,
  FOREIGN KEY (order_id) REFERENCES orders (id)
    ON DELETE CASCADE,
  FOREIGN KEY (drink_id) REFERENCES drinks (id)
);

CREATE TABLE IF NOT EXISTS order_item_additives
(
  item_id       INTEGER NOT NULL,
  order_item_id INTEGER NOT NULL,
  FOREIGN KEY (order_item_id) REFERENCES order_items (id)
    ON DELETE CASCADE,
  FOREIGN KEY (item_id) REFERENCES additives (id)
);

CREATE TABLE IF NOT EXISTS order_item_accessories
(
  item_id       INTEGER NOT NULL,
  order_item_id INTEGER NOT NULL,
  FOREIGN KEY (order_item_id) REFERENCES order_items (id)
    ON DELETE CASCADE,
  FOREIGN KEY (item_id) REFERENCES accessories (id)
);

INSERT INTO ORDERS (ID) VALUES
  (100000),
  (100001);

INSERT INTO DRINKS (ID, NAME, PRICE, TYPE) VALUES
  (100002, 'Green Tea', 10000, 'GT'),
  (100003, 'Black Tea', 10000, 'BT'),
  (100004, 'Cold Carcade', 10000, 'CC'),
  (100005, 'Latte', 15000, 'LT'),
  (100006, 'Black Coffee', 15000, 'BC'),
  (100007, 'Espresso', 15000, 'ES');

INSERT INTO ADDITIVES (ID, NAME, PRICE, TYPE) VALUES
  (100008, 'Cream', 1000, 'CR'),
  (100009, 'Milk', 1000, 'ML'),
  (100010, 'Sugar', 500, 'SG'),
  (100011, 'Honey', 1500, 'HN');

INSERT INTO ACCESSORIES (ID, NAME, PRICE, TYPE) VALUES
  (100012, 'Ice', 0, 'IC'),
  (100013, 'Straw', 0, 'ST'),
  (100014, 'Umbrella', 0, 'UM');

INSERT INTO ORDER_ITEMS (ID, DRINK_ID, ORDER_ID) VALUES
  (100015, 100002, 100000),
  (100016, 100006, 100000),
  (100017, 100004, 100001);

INSERT INTO ORDER_ITEM_ADDITIVES (ITEM_ID, ORDER_ITEM_ID) VALUES
  (100011, 100015),
  (100009, 100016);

INSERT INTO ORDER_ITEM_ACCESSORIES (ITEM_ID, ORDER_ITEM_ID) VALUES
  (100013, 100016);
